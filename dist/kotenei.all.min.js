define("kotenei/autoComplete",["jquery"],function(t){var e={LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,ENTER:13},i=function(e,i){this.$element=e,this.options=t.extend({},{url:null,zIndex:1e3,data:[],max:10,width:null,height:null,isBottom:!0,hightLight:!1,formatItem:function(t){return t},callback:{setValue:null}},i),this.tpl='<div class="k-autocomplete"></div>',this.active=0,this.init()};return i.prototype.init=function(){var i=this;this.$listBox=t(this.tpl).hide().appendTo(document.body),this.data=this.options.data||[],this.$element.on("keyup",function(o){var n=t(this),s=t.trim(n.val());switch(i.cache?i.cache!=s&&(i.cache=s,i.search(s),i.active=0):(i.cache=s,i.search(s),i.active=0),o.keyCode){case e.UP:case e.LEFT:o.preventDefault(),i.prev();break;case e.DOWN:case e.RIGHT:i.next();break;case e.ENTER:case e.TAB:i.select()}}),this.$listBox.on("click","li",function(){var e=t(this).text();if(i.$element.val(e).focus(),t.isFunction(i.options.callback.setValue)){var o=i.getItem(e);i.options.callback.setValue(o)}}),t(document).on("click.autocomplete",function(){i.hide()}),t(window).on("resize.autocomplete",function(){i.setCss()})},i.prototype.search=function(e){var i=this;if(this.options.url)t.ajax({mode:"abort",type:"GET",url:this.options.url,cache:!1,data:{keyword:e}}).done(function(t){if(t&&t instanceof Array){var o;i.data=t,o=i.getData(e),i.build(e,o),i.show()}});else if(this.options.proxy)this.options.proxy(e,function(t){i.data=t,t=i.getData(e),i.build(e,t),i.show()});else{var o=this.getData(e);this.build(e,o),this.show()}},i.prototype.getData=function(t){this.cacheData=[];var e=[],i=0;if(0===t.length)return e;for(var o,n=0;n<this.data.length;n++)if(o=this.options.formatItem(this.data[n]),o.toLowerCase().indexOf(t.toLowerCase())>=0){if(this.cacheData.push(this.data[n]),e.push(o),i===this.options.max-1)break;i++}return e},i.prototype.build=function(t,e){if(this.$listBox.find("ul").remove(),this.$listItem=null,0!==e.length){for(var i="<ul>",o=0;o<e.length;o++)i+='<li class="'+(0==o?"active":"")+'">'+this.hightLight(t,e[o])+"</li>";i+="</ul>",this.$listBox.append(i),this.$list=this.$listBox.find("ul"),this.$listItem=this.$listBox.find("li")}},i.prototype.hightLight=function(t,e){if(this.options.hightLight){var i=new RegExp("("+t+")","ig");return e=e.replace(i,"<strong>$1</strong>")}return e},i.prototype.show=function(){return this.hasItem()?(this.setCss(),void this.$listBox.show()):void this.hide()},i.prototype.getCss=function(){var t={left:this.$element.offset().left,top:this.$element.outerHeight()+this.$element.offset().top,width:this.options.width||this.$element.outerWidth()};return this.options.isBottom||(t.top=this.$element.offset().top-this.$listBox.outerHeight(!0)),t},i.prototype.setCss=function(){this.$list.css("max-height",this.options.height||"auto");var t=this.getCss();this.$listBox.css(t)},i.prototype.hide=function(){this.$listBox.hide()},i.prototype.prev=function(){this.moveSelect(-1)},i.prototype.next=function(){this.moveSelect(1)},i.prototype.hasItem=function(){return this.$listItem&&this.$listItem.length>0},i.prototype.moveSelect=function(t){if(this.hasItem()){this.active+=t,this.active<0?this.active=this.$listItem.length-1:this.active>this.$listItem.length-1&&(this.active=0);var e=this.$listItem.removeClass("active").eq(this.active).addClass("active"),i=0;this.$listItem.each(function(){i+=this.offsetHeight});var o=this.$list.scrollTop(),n=this.$list[0].clientHeight,s=e.height(),h=e.position().top;h>n?this.$list.scrollTop(h+s-n+o):0>h&&this.$list.scrollTop(o+h)}},i.prototype.select=function(){var e=this.$listBox.find("li.active"),i=e.text();if(this.$element.val(i),this.hide(),t.isFunction(this.options.callback.setValue)){var o=this.getItem(i);this.options.callback.setValue(o)}},i.prototype.getItem=function(t){var e=this.cacheData;if(e&&0!==e.length){for(var i,o=0;o<e.length;o++)if(i=this.options.formatItem(e[o]),t===i)return e[o];return null}},i}),define("kotenei/cache",[],function(){var t={},e=window.localStorage;return t.set=function(i,o,n){if(!o)return void t.remove(i);var s;/^[1-9]\d*$/.test(n)&&(s=(new Date).getTime()+1e3*parseInt(n));var h={value:o,expired:s};e.setItem(i,JSON.stringify(h))},t.get=function(i){var o=e.getItem(i),n=null;return o&&(o=JSON.parse(o),o.expired&&(new Date).getTime()>o.expired?t.remove(i):n=o.value),n},t.remove=function(t){e.removeItem(t)},t.clear=function(){e.clear()},t}),define("kotenei/clipZoom",["jquery","kotenei/dragdrop"],function(t,e){var i=function(e,i){this.$element=e,this.options=t.extend({},{imgUrl:"",scale:!0,width:400,height:300,selectorWidth:120,selectorHeight:100,callback:{clip:null}},i),this.$selector=e.find(".selector"),this.$clipZoomBox=e.find(".k-clipZoom-Box").width(this.options.width).height(this.options.height),this.$container=this.$clipZoomBox.find(".container"),this.$mainImg=this.$container.find("img"),this.$viewBox=e.find(".view-box"),this.$viewImg=this.$viewBox.find("img"),this.$resultBox=e.find(".result-box"),this.$resultImg=this.$resultBox.find("img"),this.init()};return i.prototype.init=function(){var t=this;this.$selector.width(this.options.selectorWidth).height(this.options.selectorHeight),this.$viewBox.width(this.options.selectorWidth).height(this.options.selectorHeight),this.selectorDnd=new e({$layer:this.$selector,$range:this.$clipZoomBox,resizable:!0,scale:this.options.scale,callback:{resize:function(){t.setPreview()},move:function(){t.setPreview()}}}),this.imgLoad(),this.eventBind()},i.prototype.eventBind=function(){var t=this;this.$element.on("click",'[role="clip"]',function(){t.clip()}).on("click",'[role="center"]',function(){t.center()}).on("click",'[role="reset"]',function(){t.reset()}).on("click",'[role="plus"]',function(){t.zoom(!0)}).on("click",'[role="minus"]',function(){t.zoom(!1)})},i.prototype.setImgSize=function(t,e){this.$mainImg.width(t).height(e)},i.prototype.imgLoad=function(){var t=this,i=new Image;i.onload=function(){var o=t.getSize(i.width,i.height,t.options.width);i.width<t.options.width&&(o.width=i.width,o.height=i.height),t.$container.width(o.width).height(o.height).css({left:0,top:0}),t.$mainImg.attr("src",t.options.imgUrl).width(o.width).height(o.height),t.$viewImg.attr("src",t.options.imgUrl).width(o.width).height(o.height),t.resetSize={width:o.width,height:o.height,left:0,top:0},t.containerDnd=new e({$layer:t.$container,$range:t.$clipZoomBox,resizable:!0,boundary:!0,scale:!0,callback:{resize:function(e){t.setImgSize(e.width,e.height),t.setPreview()},move:function(){t.setPreview()}}}),t.setPreview()},i.onerr=function(){alert("图片加载失败")},i.src=this.options.imgUrl},i.prototype.getSize=function(t,e,i){var o;return t>=e?(o=t/e,e=i/o):(o=e/t,e=i*o),{width:parseInt(i),height:parseInt(e)}},i.prototype.zoom=function(t){var e,i=this.$container.width(),o=this.$container.height();e=t?i/.8:.8*i;var n=this.getSize(i,o,e);this.$container.width(n.width).height(n.height),this.$mainImg.width(n.width).height(n.height),this.$viewImg.width(n.width).height(n.height),this.setPreview()},i.prototype.clip=function(){var e={imgSource:this.options.imgUrl,imgWidth:this.$viewImg.width(),imgHeight:this.$viewImg.height(),imgX:Math.abs(this.$viewImg[0].style.marginLeft.replace("px",""))-this.$viewImg.position().left,imgY:Math.abs(this.$viewImg[0].style.marginTop.replace("px",""))-this.$viewImg.position().top,selectorX:this.$selector.position().left,selectorY:this.$selector.position().top,cutterWidth:this.options.selectorWidth,cutterHeight:this.options.selectorHeight};t.isFunction(this.options.callback.clip)&&this.options.callback.clip(e)},i.prototype.center=function(){var t=parseInt(this.$mainImg.width()),e=parseInt(this.$mainImg.height()),i=parseInt(this.$selector.width()),o=parseInt(this.$selector.height()),n=parseInt(this.options.width),s=parseInt(this.options.height),h=this.getSize(t,e,i);h.height<o&&(h.width=t/e*o,h.height=o),this.$mainImg.width(h.width).height(h.height),this.$viewImg.width(h.width).height(h.height),this.$container.width(h.width).height(h.height).css({top:(s-h.height)/2,left:(n-h.width)/2}),this.$selector.css({top:(s-o)/2,left:(n-i)/2}),this.setPreview()},i.prototype.reset=function(){this.$container.width(this.resetSize.width).height(this.resetSize.height).css({left:0,top:0}),this.$mainImg.width(this.resetSize.width).height(this.resetSize.height),this.$viewImg.width(this.resetSize.width).height(this.resetSize.height),this.setPreview()},i.prototype.setPreview=function(){{var t=this.options,e=this.getPreviewInfo(),i=t.selectorWidth,o=t.selectorHeight;e.viewPortWidth,e.viewPortHeight}if(e.selectorWidth>0){var n=i/e.selectorWidth,s=o/e.selectorHeight;this.$viewImg.css({width:Math.round(n*e.imgWidth),height:Math.round(s*e.imgHeight),left:Math.round(n*e.imgX),top:Math.round(s*e.imgY),marginLeft:-Math.round(n*e.selectorX),marginTop:-Math.round(s*e.selectorY)})}},i.prototype.getPreviewInfo=function(){var t=this.options;return{imgWidth:this.$mainImg.width(),imgHeight:this.$mainImg.height(),imgX:this.$container.position().left,imgY:this.$container.position().top,selectorWidth:this.$selector.width(),selectorHeight:this.$selector.height(),selectorX:this.$selector.position().left,selectorY:this.$selector.position().top,viewPortWidth:t.width,viewPortHeight:t.height}},i}),define("kotenei/dragdrop",["jquery"],function(t){var e=function(e){this.options=t.extend({},{$layer:null,$handle:null,$range:null,direction:"",resizable:!1,scale:!1,boundary:!1,minWidth:100,callback:{start:t.noop,move:t.noop,stop:t.noop,resize:t.noop}},e),this.$layer=e.$layer,this.$handle=e.$handle,this.$range=e.$range,this.$window=t(window),this.$document=t(document),this.isResize=!1,this.moving=!1,this.offset={x:0,y:0},this.originalCoord={x:0,y:0},this.resizeParams={left:0,top:0,width:0,height:0,type:"bottomRight"},this.init()};return e.prototype.init=function(){this.$layer&&(this.$range&&this.$range.css("position","relative"),this.$handle=this.$handle||this.$layer,this.$layer.css({cursor:"move",position:"absolute"}),this.options.resizable&&(this.$layer.append('<span class="k-resizable k-resizable-topLeft" data-type="topLeft"></span>'),this.$layer.append('<span class="k-resizable k-resizable-topRight" data-type="topRight"></span>'),this.$layer.append('<span class="k-resizable k-resizable-bottomLeft" data-type="bottomLeft"></span>'),this.$layer.append('<span class="k-resizable k-resizable-bottomRight" data-type="bottomRight"></span>'),this.options.scale||(this.$layer.append('<span class="k-resizable k-resizable-topCenter" data-type="topCenter"></span>'),this.$layer.append('<span class="k-resizable k-resizable-leftCenter" data-type="leftCenter"></span>'),this.$layer.append('<span class="k-resizable k-resizable-rightCenter" data-type="rightCenter"></span>'),this.$layer.append('<span class="k-resizable k-resizable-bottomCenter" data-type="bottomCenter"></span>'))),this.setMinSize(),this.eventBind())},e.prototype.setMinSize=function(){var t,e=this.$layer.outerWidth(),i=this.$layer.outerHeight();this.minWidth=this.options.minWidth||e,e>=i?(t=e/i,this.minHeight=this.minWidth/t):(t=i/e,this.minHeight=this.minWidth*t)},e.prototype.eventBind=function(){var e=this;this.$handle.on("mousedown",function(t){t.stopPropagation(),t.preventDefault(),e.start(t),document.onselectstart=function(){return!1}}).on("mousedown",".k-resizable",function(){e.isResize=!0,e.resizeParams.type=t(this).attr("data-type"),e.resizeParams.left=parseInt(e.$layer.position().left),e.resizeParams.top=parseInt(e.$layer.position().top),e.resizeParams.width=parseInt(e.$layer.outerWidth()),e.resizeParams.height=parseInt(e.$layer.outerHeight()),e.resizeParams.ratio=e.resizeParams.width>=e.resizeParams.height?e.resizeParams.width/e.resizeParams.height:e.resizeParams.height/e.resizeParams.width})},e.prototype.start=function(e){var i=this;this.$document.on("mousemove",function(t){i.isMoving&&(i.isResize?i.resize(t):i.move(t))}).on("mouseup",function(e){i.stop(e),t(this).off()});var o=this.getMouseCoord(e);return this.offset.x=o.x-this.$layer.position().left,this.offset.y=o.y-this.$layer.position().top,this.originalCoord.x=o.x,this.originalCoord.y=o.y,this.$handle[0].setCapture&&this.$handle[0].setCapture(),this.isMoving=!0,t.isFunction(this.options.callback.start)&&this.options.callback.start(e,this.$layer),!1},e.prototype.move=function(e){var i,o,n=this.getMouseCoord(e),s={x:n.x-this.offset.x,y:n.y-this.offset.y},h=this.$range;h?(i=h.width()-this.$layer.outerWidth(!0),o=h.height()-this.$layer.outerHeight(!0),this.options.boundary||(s.x<0&&(s.x=0),s.y<0&&(s.y=0),s.x>i&&(s.x=i),s.y>o&&(s.y=o))):(i=this.$window.width()-this.$layer.outerWidth()+this.$document.scrollLeft(),o=this.$window.height()-this.$layer.outerHeight()+this.$document.scrollTop(),s.x<0&&(s.x=0),s.y<0&&(s.y=0),s.x>i&&(s.x=i),s.y>o&&(s.y=o)),this.setPosition(s),t.isFunction(this.options.callback.move)&&this.options.callback.move(s)},e.prototype.resize=function(e){var i,o,n=this.getMouseCoord(e),s={x:n.x-this.offset.x,y:n.y-this.offset.y},h=(this.$layer,this.resizeParams),r={left:0,top:0,width:0,height:0},a=this.$range;switch(a?(i=a.width(),o=a.height()):(i=this.$window.width()+this.$document.scrollLeft(),o=this.$window.height()+this.$document.scrollTop()),this.resizeParams.type){case"topLeft":r.width=h.width+(h.left-s.x),r.width=r.width<this.minWidth?this.minWidth:r.width,r.height=this.getScaleHeight(r.width),r.top=h.top-(r.height-h.height),r.left=h.left-(r.width-h.width),r.left<0&&(r.left=0,r.width=h.width+h.left,r.height=this.getScaleHeight(r.width),r.top=h.top-(r.height-h.height)),r.top<0&&(r.top=0,r.height=h.height+h.top,r.width=this.getScaleWidth(r.height),r.left=h.left-(r.width-h.width));break;case"topRight":r.left=h.left,r.width=h.width-(this.originalCoord.x-n.x),r.width=r.width<this.minWidth?this.minWidth:r.width,r.height=this.getScaleHeight(r.width),r.width+r.left>=i&&(r.width=i-h.left,r.height=this.getScaleHeight(r.width)),r.top=h.top-(r.height-h.height),r.top<0&&(r.top=0,r.height=h.height+h.top,r.width=this.getScaleWidth(r.height));break;case"leftCenter":r.top=h.top,r.height=h.height,s.x<=0?(r.left=0,r.width=h.width+h.left):(r.left=s.x,r.width=h.width+(this.originalCoord.x-n.x)),r.width<=this.minWidth&&(r.width=this.minWidth,r.left=h.left+(h.width-r.width));break;case"rightCenter":r.top=h.top,r.left=h.left,r.height=h.height,r.width=h.width-(this.originalCoord.x-n.x),r.width+r.left>=i&&(r.width=i-h.left),r.width<=this.minWidth&&(r.width=this.minWidth);break;case"topCenter":r.top=s.y,r.left=h.left,r.width=h.width,r.height=h.height+(this.originalCoord.y-n.y),s.y<0&&(r.top=0,r.height=h.height+h.top),r.height<=this.minHeight&&(r.height=this.minHeight,r.top=h.top+(h.height-r.height));break;case"bottomCenter":r.top=h.top,r.left=h.left,r.width=h.width,r.height=h.height-(this.originalCoord.y-n.y),r.height+r.top>=o&&(r.height=o-h.top),r.height<=this.minHeight&&(r.height=this.minHeight);break;case"bottomLeft":r.top=h.top,r.width=h.width+(this.originalCoord.x-n.x),r.width=r.width<this.minWidth?this.minWidth:r.width,r.height=this.getScaleHeight(r.width),r.left=h.left-(r.width-h.width),r.left<=0&&(r.left=0,r.width=h.width+h.left,r.height=this.getScaleHeight(r.width)),r.height+r.top>=o&&(r.height=o-r.top,r.width=this.getScaleWidth(r.height),r.left=h.left-(r.width-h.width));break;case"bottomRight":r.top=h.top,r.left=h.left,r.width=h.width-(this.originalCoord.x-n.x),r.width=r.width<this.minWidth?this.minWidth:r.width,r.height=this.getScaleHeight(r.width),r.width+r.left>=i&&(r.width=i-h.left,r.height=this.getScaleHeight(r.width)),r.top+r.height>=o&&(r.height=o-r.top,r.width=this.getScaleWidth(r.height))}this.$layer.css(r),t.isFunction(this.options.callback.resize)&&this.options.callback.resize(r)},e.prototype.getScaleWidth=function(t,e){return e=e||this.resizeParams.ratio,this.resizeParams.width>=this.resizeParams.height?t*e:t/e},e.prototype.getScaleHeight=function(t,e){return e=e||this.resizeParams.ratio,this.resizeParams.width>=this.resizeParams.height?t/e:t*e},e.prototype.stop=function(e){this.isMoving=!1,this.isResize=!1,this.$handle[0].releaseCapture&&this.$handle[0].releaseCapture(),t.isFunction(this.options.callback.stop)&&this.options.callback.stop(e,this.$layer)},e.prototype.getMouseCoord=function(t){return{x:t.pageX||t.clientX+document.body.scrollLeft-document.body.clientLeft,y:t.pageY||t.clientY+document.body.scrollTop-document.body.clientTop}},e.prototype.setPosition=function(t){"h"===this.options.direction?this.$layer.css("left",t.x):"v"===this.options.direction?this.$layer.css("top",t.y):this.$layer.css({left:t.x,top:t.y})},e}),define("kotenei/dropdown",["jquery"],function(t){var e=t("body"),i=t(document),o=0,n=function(e,i){this.$soure=e,this.setting=t.extend({width:e.width(),height:e.height()},i||{}),e.data("widget",this),o++,this.id=o,this.nameSpace="dropdown_"+String(this.id),this.initDom()};return n.prototype.initDom=function(){var e=this.$soure.parent();this.$soure.css({visibility:"hidden"}),"static"===e.css("position")&&e.css({visibility:"relative"});var i=1;"auto"===this.$soure.css("zIndex")?this.$soure.css("zIndex",1):i=Number(this.$soure.css("zIndex")),this.$el=t('<div class="widget-dropbox"/>').css({width:this.setting.width,height:this.setting.height,zIndex:i+1}),this.$label=t('<div class="label"/>').css({width:this.setting.width-this.setting.height,height:this.setting.height,lineHeight:String(this.setting.height-4)+"px"}).appendTo(this.$el),this.$icon=t('<div class="ic">&#9660;</div>').css({width:this.setting.height,height:this.setting.height,lineHeight:String(this.setting.height)+"px"}).appendTo(this.$el),this.buildDrop(),this.$el.insertBefore(this.$soure),this.watch()},n.prototype.syncPosition=function(){this.$el.css(this.$soure.position())},n.prototype.setLabel=function(t){this.$label.text(t).attr("title",t)},n.prototype.getVal=function(){return this.$soure.val()},n.prototype.setVal=function(t){this.$soure.val(t).change()},n.prototype.buildDrop=function(){this.$drop&&this.$drop.remove(),this.$drop=t('<div class="widget-dropbox-drop"/>').css({width:this.setting.width}).hide();var i=[];this.$soure.find("option").each(function(){var e=t(this);i.push('<li data-val="'+e.val()+'">'+e.text()+"</li>")});var o=t("<ul>"+i.join("")+"</ul>");o.appendTo(this.$drop),this.$drop.appendTo(e),this.syncPosition(),this.sync()},n.prototype.sync=function(){var t=this.$soure.find("option:selected").text();if(!t){var e=this.$soure.find("option").eq(0);t=e.text(),this.setVal(e.val())}this.setLabel(t)},n.prototype.showDrop=function(){var e=this,o=e.$el.offset();e.$el.addClass("widget-dropbox-hover"),e.$drop.css({top:o.top+e.setting.height+2,left:o.left}).show(),i.on("click."+e.nameSpace,function(i){i.target!==e.$label[0]&&i.target!==e.$icon[0]&&i.target!==e.$drop[0]&&!1===t.contains(e.$drop[0],i.target)&&e.hideDrop()})},n.prototype.hideDrop=function(){var t=this;t.$drop.hide(),t.$el.removeClass("widget-dropbox-hover"),i.off("click."+t.nameSpace)},n.prototype.watch=function(){var e=this;this.$el.on("click",function(){e.showDrop()}),this.$drop.on("click","li",function(){var i=t(this);return e.setVal(i.data("val")),e.sync(),e.hideDrop(),!1})},n.prototype.reload=function(){this.buildDrop()},n}),define("kotenei/dropdownDatepicker",["jquery","kotenei/dropdown","kotenei/util","foundation-datepicker"],function(t,e,i){t.fn.fdatepicker.dates["zh-CN"]={days:["日","一","二","三","四","五","六","日"],daysShort:["日","一","二","三","四","五","六","日"],daysMin:["日","一","二","三","四","五","六","日"],months:["1 月","2 月","3 月","4 月","5 月","6 月","7 月","8 月","9 月","10 月","11 月","12 月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],today:"今天"};var o=function(t,i){e.call(this,t,i)};return o.prototype=i.createProto(e.prototype),o.prototype.buildDrop=function(){if(!this.$drop){var e=this;e.$drop=t('<div class="widget-dropbox-drop"/>').css({width:242,height:252}).hide(),e.$el.fdatepicker(t.extend({format:"yyyy-mm-dd",language:"zh-CN"},e.setting)).on("changeDate",function(){var t=e.datepicker.getFormattedDate();e.setVal(t),e.setLabel(t)}),e.datepicker=e.$el.data("datepicker"),e.datepicker.picker.appendTo(e.$drop),e.$drop.appendTo(t("body")),e.syncPosition(),e.sync()}},o.prototype.watch=function(){var t=this;this.$el.on("click",function(){t.showDrop()})},o.prototype.sync=function(){var t=this.getVal();if(t)this.$el.data("date",t),this.datepicker.update(),this.setLabel(t);else{var e=this.$soure.attr("placeholder")||"选择日期";this.setLabel(e)}},o}),define("kotenei/infiniteScroll",["jquery"],function(t){var e=function(e){var i=this;this.options=t.extend({},{$scrollElement:t(window),$watchElement:null,scrollDistance:.3,callback:t.noop},e),this.$scrollElement=this.options.$scrollElement,this.$watchElement=this.options.$watchElement,this.$watchElement&&(this.$scrollElement.on("scroll.infiniteScroll",function(){i.scroll()}),this.scroll())};return e.prototype.scroll=function(){var t=this.$scrollElement.height(),e=t+this.$scrollElement.scrollTop(),i=this.$watchElement.offset().top+this.$watchElement.height(),o=i-e,n=o<=t*this.options.scrollDistance;n&&this.options.callback()===!1&&this.destroy()},e.prototype.destroy=function(){this.$scrollElement.off("scroll.infiniteScroll")},e}),define("kotenei/lazyload",["jquery"],function(t){function e(e,i){this.$elements=e,this.options=t.extend({},{placeholder:null,$container:t(window),callback:t.noop},i),this.cache=[],this.init()}return e.prototype.init=function(){var e=this;this.$elements.each(function(){if("img"==this.nodeName.toLowerCase()){var i=t(this),o={};null!=e.options.placeholder&&(this.setAttribute("data-url",this.src),this.src=e.options.placeholder),this.getAttribute("data-url")&&(o.$elm=i,o.url=this.getAttribute("data-url"),e.cache.push(o))}}),0!==this.cache.length&&(this.count=this.cache.length,this.eventBind(),this.load())},e.prototype.eventBind=function(){this.options.$container.on("scroll.lazyload",t.proxy(this.load,this))},e.prototype.load=function(){var e=this,i=this.getPosition();this.count<=0||t.each(this.cache,function(t,o){{var n,s,h=o.$elm,r=o.url;o.tag}h&&(s=h.offset().top,n=[s-i.top,s-i.top+h.height()],(n[0]>=0&&n[0]<i.height||n[1]>0&&n[1]<=i.height)&&(!function(t,i){e.imgLoad(t,i,function(){t.hide().fadeIn(),e.callback(t)})}(h,r),o.$elm=null,e.count--))})},e.prototype.imgLoad=function(t,e,i){var o=new Image;o.onload=function(){t.attr("src",e),i()},o.onerror=function(){i()},o.src=e},e.prototype.getPosition=function(){var t,e={},i=this.options.$container,o=i.height();return t=i[0]===window?i.scrollTop():i.offset().top,e.height=o,e.top=t,e},e.prototype.callback=function(e){t.isFunction(this.options.callback)&&this.options.callback(e)},function(i,o){return i=i||t("img"),new e(i,o)}}),define("kotenei/loading",["jquery","spin"],function(t,e){var i,o=function(e){this.options=t.extend({},{lines:12,length:10,width:4,radius:14,corners:1,rotate:0,direction:1,color:"white",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"70px",left:"70px"},e),this.tpl='<div class="k-loading"></div>',this.init()};return o.prototype.init=function(){this.spinner=new e(this.options),this.$loading=t(this.tpl).appendTo(document.body).hide()},o.prototype.show=function(){this.spinner.spin(this.$loading.get(0)),this.$loading.fadeIn("fast")},o.prototype.hide=function(){this.$loading.hide(),this.spinner.stop()},o.show=function(){i||(i=new o),i.show()},o.hide=function(){i&&i.hide()},o}),define("kotenei/pager",["jquery"],function(t){var e=function(e,i){this.$element=e,this.options=t.extend({},{className:"k-pagination",onclick:t.noop},i),this.curPage=1,this.totalCount=0,this.pageSize=10,this.template='<div class="pager-box"></div>'};return e.prototype.init=function(){if(0!==this.totalCount){var e=this;this.$pager=t(this.template).append(this.build()).appendTo(this.$element),this.$pager.on("click","li",function(){var i=t(this),o=i.attr("data-page");i.hasClass("disabled")||i.hasClass("active")||(e.curPage=parseInt(o),e.$pager.html(e.build()),e.options.onclick(e.curPage))})}},e.prototype.build=function(){var t,e=this.getInfo(),i=[];i.push('<ul class="'+this.options.className+'">'),t=this.curPage>1?"":"disabled",i.push('<li class="'+t+'" data-page="'+e.pre+'" ><a href="javascript:void(0);">«</a></li>');for(var o=e.start;o<=e.end;o++)t=o===this.curPage?"active":"",i.push('<li class="'+t+'" data-page="'+o+'" ><a href="javascript:void(0);">'+o+"</a></li>");return t=this.curPage!==e.allPage?"":"disabled",i.push('<li class="'+t+'" data-page="'+e.next+'" ><a href="javascript:void(0);">»</a></li>'),i.push("</ul>"),i.join("")},e.prototype.getInfo=function(){var t,e,i,o,n;return n=parseInt(this.totalCount/this.pageSize),n=this.totalCount%this.pageSize!==0?n+1:n,n=0===n?1:n,t=this.curPage+2>n?n-4:this.curPage-2,e=this.curPage<4?5:this.curPage+2,1>t&&(t=1),e>n&&(e=n),i=this.curPage-1<1?1:this.curPage-1,o=this.curPage+1>n?n:this.curPage+1,{start:t,end:e,pre:i,next:o,allPage:n}},e}),define("kotenei/placeholder",["jquery"],function(t){function e(e){e.each(function(){var e=t(this),o=e.data("placeholder");if(void 0===o){var n=t.trim(e.attr("placeholder"));if(!n||0===n.length)return;o=new i(e),e.data("placeholder",o)}else o.setPosition()})}var i=function(t){this.$elm=t,this.type="placeholder",this.init()};return i.prototype.init=function(){var e=t.trim(this.$elm.attr("placeholder"));this.timer=this.$elm.attr("data-timer"),this.timer&&(this.timer=JSON.stringify(this.timer)),this.$placeholder=t("<div/>").addClass("placeholder").text(e).insertAfter(this.$elm).hide(),this.$elm.parent().css("position","relative"),this.setPosition(),this.eventBind()},i.prototype.eventBind=function(){var e=this;this.timer&&setInterval(function(){e.setPosition()},this.timer.delay),this.$elm.on("focus."+this.type,function(){e.$placeholder.hide()}).on("blur."+this.type,function(){var i=t.trim(e.$elm.val());0===i.length||i===e.text?(e.$elm.val(""),e.$placeholder.show()):e.$placeholder.hide()}),this.$placeholder.on("focus."+this.type,function(){e.$elm.focus()})},i.prototype.display=function(){var e=t.trim(this.$elm.val());0===e.length||e===t.trim(this.$elm.attr("placeholder"))?this.$placeholder.show():this.$placeholder.hide()},i.prototype.setPosition=function(){var t=this;setTimeout(function(){var e={left:t.$elm[0].offsetLeft,top:t.$elm[0].offsetTop,height:t.$elm.outerHeight(),width:t.$elm.outerWidth(),position:"absolute",paddingLeft:"10px",paddingRight:"10px",paddingTop:0,margin:0,lineHeight:t.$elm.outerHeight()+"px",cursor:"text",color:"#999"};"textarea"===t.$elm[0].nodeName.toLowerCase()&&(e.lineHeight="auto",e.paddingTop=5),t.$placeholder.css(e),t.display()},50)},function(i){"placeholder"in document.createElement("input")||(i=i||t("input,textarea"),e(i))}}),define("kotenei/popTips",["jquery"],function(t){var e=function(){function e(){function e(e,s,h,r){n&&clearTimeout(n),t.isFunction(h)&&(r=h,h=3e3),r=r||t.noop,h=h||3e3,o&&o.stop().remove(),o=t(i(e,s)).appendTo(document.body).hide(),o.css({marginLeft:-(o.width()/2),marginTop:-(o.height()/2)}).fadeIn("fase",function(){n=setTimeout(function(){o.stop().remove(),r()},h)})}function i(t,e){var i=[];switch(t){case"success":i.push('<div class="k-pop-tips success"><span class="fa fa-check"></span>&nbsp;<span>'+e+"</span></div>");break;case"error":i.push('<div class="k-pop-tips error"><span class="fa fa-close"></span>&nbsp;<span>'+e+"</span></div>");break;case"warning":i.push('<div class="k-pop-tips warning"><span class="fa fa-exclamation"></span>&nbsp;<span>'+e+"</span></div>")}return i.join("")}var o,n;return{success:function(t,i,o){e("success",t,i,o)},error:function(t,i,o){e("error",t,i,o)},warning:function(t,i,o){e("warning",t,i,o)}}}var i;return{getInstance:function(){return i||(i=e()),i}}}();return e.getInstance()}),function(t){var e={addEventListener:function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},removeEventListener:function(t,e){t.removeEventListener?t.removeEventListener(e,handler,!1):t.detachEvent?t.detachEvent("on"+e,handler):t["on"+e]=null},proxy:function(t,e){var i=function(){return t.apply(e||this,arguments)};return i}},i=function(){this._routes=[]};i.prototype.init=function(){var i=this;e.addEventListener(t,"hashchange",e.proxy(i.listener,this)),this.listener()},i.prototype.listener=function(){var t,e=location.hash.slice(1).split("?"),i=e[0];e[1]&&(t=this.getUrlParams(e[1]));var o,n=this.getRoute(i),s={};if(!n)return void location.replace("#/");o=this.getValues(i,n);for(var h=0;h<n.params.length;h++)s[n.params[h]]=o[h];t=$.extend({},s,t),n.handle(t)},i.prototype.getUrlParams=function(t){var e={};if(!t)return e;for(var i,o=t.split("&"),n=0;n<o.length;n++)i=o[n].split("="),e[i[0]]=i[1];return e},i.prototype.map=function(t,e,i){var o,n,s,h=[];if(n=t.replace(/\//g,"\\/"),"function"==typeof e&&(i=e,e=null),e)for(var r in e)o=new RegExp("\\{"+r+"\\}","g"),n=n.replace(o,"("+e[r].replace(/\^/,"").replace(/\$/,"")+")"),h.push(r);for(o=new RegExp("{([^}]+)}","g");null!=(s=o.exec(n));)h.push(s[1]),o.lastIndex;return n="^"+n.replace(/{[^}]+}/gi,"(.+)")+"$",this._routes.push({routeUrl:t,pattern:n,params:h,handle:i||function(){}}),this},i.prototype.getValues=function(t,e){var e,i=[];if(0===t.length)return i;if(e=e||this.getRoute(t),null!=e){var o=t.match(e.pattern);if(0!=o.length)for(var n=1;n<o.length;n++)i.push(o[n])}return i},i.prototype.getRoute=function(t){for(var e=0;e<this._routes.length;e++)if(new RegExp(this._routes[e].pattern).test(t))return this._routes[e];return null},"function"==typeof t.define&&define.amd?define("kotenei/router",[],function(){return i}):t.Router=i}(window),define("kotenei/slider",["jquery","kotenei/dragdrop"],function(t,e){var i=function(e,i){this.$element=e,this.options=t.extend({},{min:1,max:10,step:1,value:1,$bindElement:t([]),callback:{slide:t.noop}},i),this.template='<div class="k-slider"><div class="k-slider-selection"></div><div class="k-slider-handle"></div></div>',this.min=this.options.min,this.max=this.options.max,this.step=this.options.step,this.diff=this.max-this.min,this.init()};return i.prototype.init=function(){var i=this;this.$slider=t(this.template).appendTo(this.$element),this.$sliderSelection=this.$slider.find("div.k-slider-selection"),this.$sliderHandle=this.$slider.find("div.k-slider-handle"),this.handleWidth=this.$sliderHandle.width(),this.sliderWidth=this.$slider.outerWidth(),this.$bindElement=this.options.$bindElement,this.dragdrop=new e({$range:this.$slider,$layer:this.$slider.find(".k-slider-handle"),direction:"h",callback:{move:function(t){var e=i.getMoveValue(t);i.setValue(e),i.options.callback.slide(e)}}}),this.eventBind(),this.setValue(this.options.value)},i.prototype.eventBind=function(){if(this.allowElement()){var e=this.$bindElement[0].type,i=this;-1!==e.indexOf("select")?this.$bindElement.on("change",function(){var e=t(this),o=t.trim(i.getFilterValue(e.val()));i.setValue(o)}):this.$bindElement.on("keyup",function(e){var o=t(this),n=t.trim(i.getFilterValue(o.val()));13===e.keyCode&&i.setValue(n)})}},i.prototype.allowElement=function(){if(0===this.$bindElement.length)return!1;var t=this.$bindElement[0].type;return"text"!==t&&"textarea"!==t&&-1===t.indexOf("select")?!1:!0},i.prototype.getFilterValue=function(t){return t||(t=this.min),isNaN(t)&&(t=this.min),t<this.min&&(t=this.min),t>this.max&&(t=this.max),t},i.prototype.setValue=function(t){t>this.max&&(t=this.max),t<this.min&&(t=this.min);var e=(t-this.min)/this.diff*100;this.setPercent(e),this.setElementValue(t)},i.prototype.setElementValue=function(t){if(this.allowElement()){var e=this.$bindElement[0].type;-1!=e.indexOf("select")?this.$bindElement.find("option[value='"+t+"']").prop("selected",!0):this.$bindElement.val(t)}},i.prototype.getMoveValue=function(t){var e=t.x/(this.sliderWidth-this.handleWidth)*100,i=Math.round(e/100*this.diff/this.step)*this.step+this.min;return i=i>this.max?this.max:i},i.prototype.setPercent=function(t){this.$sliderSelection.width(t+"%"),this.$sliderHandle.css("left",t+"%")},i}),define("kotenei/switch",["jquery"],function(t){var e=function(e,i){this.$element=e,this.options=t.extend({},{values:{on:{text:"on",value:"1",className:""},off:{text:"off",value:"0",className:""}},callback:{onclick:t.noop}},i),this.template='<div class="k-switch"></div>',this.init()
};return e.prototype.init=function(){"checkbox"===this.$element[0].type&&(this.$switch=t(this.template).append(this.build()).insertAfter(this.$element),this.$switchScroller=this.$switch.find(".k-switch-scroller"),this.$element.hide(),this.checked="checked"===this.$element.attr("checked"),this.disabled="disabled"===this.$element.attr("disabled"),this.moveLeft=this.$switch.find(".k-switch-left").width(),this.checked?this.on():this.off(),this.disabled&&this.$switch.addClass("disabled"),this.$switch.on("click",t.proxy(this.toggle,this)))},e.prototype.build=function(){var t=[],e=this.options.values;return t.push('<div class="k-switch-scroller">'),t.push('<span class="k-switch-left" >'+e.on.text+"</span>"),t.push('<span class="k-switch-middle"></span>'),t.push('<span class="k-switch-right">'+e.off.text+"</span>"),t.push("</div>"),t.join("")},e.prototype.toggle=function(){this.disabled||(this.checked?(this.checked=!1,this.off()):(this.checked=!0,this.on()),this.options.callback.onclick(this.get()))},e.prototype.on=function(){this.disabled||(this.$element.prop("checked",!0),this.$switchScroller.stop().animate({left:0},300))},e.prototype.off=function(){this.disabled||(this.$element.prop("checked",!1),this.$switchScroller.stop().animate({left:-this.moveLeft},300))},e.prototype.get=function(){var t=this.options.values;return this.checked?t.on.value:t.off.value},e.prototype.destroy=function(){this.$switch.off("click"),this.$element.show(),this.$switch.remove()},e}),define("kotenei/tooltips",["jquery"],function(t){function e(e,i){this.$element=e,this.options=t.extend({},{delay:0,content:"",tipClass:"",placement:"right",trigger:"hover click",container:t(document.body),scrollContainer:null},i),this.tpl='<div class="k-tooltips"><div class="k-tooltips-arrow"></div><div class="k-tooltips-title"></div><div class="k-tooltips-inner"></div></div>',this.init()}return e.prototype.init=function(){var e=this;this.$tips=t(this.tpl),this.$tips.addClass(this.options.placement).addClass(this.options.tipClass),this.$container=t(this.options.container),this.setContent(),this.isShow=!1;for(var i,o=this.options.trigger.split(" "),n=0;n<o.length;n++)if(i=o[n],"click"===i)this.$element.on(i+".tooltips",t.proxy(this.toggle,this));else if("manual"!=i){var s="hover"===i?"mouseenter":"focus",h="hover"===i?"mouseleave":"blur";this.$element.on(s,t.proxy(this.show,this)),this.$element.on(h,t.proxy(this.hide,this))}"BODY"!==this.$container[0].nodeName&&this.$container.css("position","relative"),this.$container.append(this.$tips),this.options.scrollContainer&&t(this.options.scrollContainer).on("scroll.tooltips",function(){console.log("")}),t(window).on("resize.tooltips",function(){e.setPosition()}),this.hide()},e.prototype.setContent=function(e){e=t.trim(e||this.options.content),0===e.length&&(e=this.$element.attr("data-content")||"");var i=this.$tips;i.find(".k-tooltips-inner").html(e)},e.prototype.setPosition=function(){var t=this.getPosition();this.$tips.css(t)},e.prototype.getPosition=function(){var t=this.options.placement,e=(this.options.container,this.$element),i=(e.parent(),this.$tips),o=e.outerWidth(),n=e.outerHeight(),s=i.outerWidth(),h=i.outerHeight(),r={left:0,top:0},a=e[0];do r.left+=a.offsetLeft-a.scrollLeft,r.top+=a.offsetTop-a.scrollTop;while((a=a.offsetParent)&&a!=this.$container[0]);switch(t){case"left":return{top:r.top+n/2-h/2,left:r.left-s};case"top":return{top:r.top-h,left:r.left+o/2-s/2};case"right":return{top:r.top+n/2-h/2,left:r.left+o};case"bottom":return{top:r.top+n,left:r.left+o/2-s/2}}},e.prototype.show=function(){return 0===t.trim(this.options.content).length?void this.hide():(this.isShow=!0,this.setPosition(),this.$tips.show().addClass("in"),void this.setPosition())},e.prototype.hide=function(){this.isShow=!1,this.$tips.hide().removeClass("in")},e.prototype.toggle=function(){this.isShow?this.hide():this.show()},e.Global=function(i){var i=i||t('[data-module="tooltips"]');i.each(function(){var i=t(this),o=e.Get(i);o||(o=new e(i,{title:i.attr("data-title"),content:i.attr("data-content"),placement:i.attr("data-placement"),tipClass:i.attr("data-tipClass"),trigger:i.attr("data-trigger")}),e.Set(i,o))})},e.Get=function(t){return t.data("tooltips")},e.Set=function(t,e){t.data("tooltips",e)},e}),define("kotenei/tree",["jquery","kotenei/dragdrop"],function(t){var e={data:[],edit:{enable:!1,showAddBtn:!1,showEditBtn:!1,showRemvoeBtn:!1},check:{enable:!1,chkType:"checkbox",chkBoxType:{Y:"ps",N:"ps"}},callback:{beforeCheck:null,beforeSelect:null,beforeAdd:null,beforeRename:null,beforeExpand:null,beforeRemove:null,onCheck:null,onSelect:null,onAdd:null,onRename:null,onExpand:null,onRemove:null}},i={className:{ICON:"icon",SWITCH:"switch"},floder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},line:{ROOT:"root",CENTER:"center",BOTTOM:"bottom"},node:{SELECTED:"selected"}},o={isArray:function(t){return t instanceof Array}},n={getLineHtml:function(t){var e=i.line.CENTER;return t.isFirst&&0===t.parentId?e=i.line.ROOT:t.isLast&&(e=i.line.BOTTOM),e+=t.hasChildren?t.open?"_"+i.floder.OPEN:"_"+i.floder.CLOSE:"_"+i.floder.DOCU,'<span id="switch_'+t.nodeId+'" nId="'+t.nodeId+'" class="'+i.className.ICON+" "+i.className.SWITCH+" "+e+'"></span>'},getIconHtml:function(t){return html='<span id="'+i.className.ICON+"_"+t.nodeId+'" class="'+i.className.ICON+" ico_"+i.floder.DOCU+'"></span>',t.hasChildren&&(html=t.open?'<span id="'+i.className.ICON+"_"+t.nodeId+'"  class="'+i.className.ICON+" ico_"+i.floder.OPEN+'"></span>':'<span id="'+i.className.ICON+"_"+t.nodeId+'"  class="'+i.className.ICON+" ico_"+i.floder.CLOSE+'"></span>'),html},getChkHtml:function(t,e){return!e.check.enable||t.noCheck?"":'<span id="chk_'+t.nodeId+'" nId="'+t.nodeId+'" class="'+i.className.ICON+" chk "+e.check.chkType+"_"+String(t.checked===!0)+"_"+(t.chkDisabled?"part":"full")+'"></span>'},getOperateHtml:function(t,e){var o=[];return e.edit.enable?(e.edit.showAddBtn&&o.push('<span id="add_'+t.nodeId+'" nId="'+t.nodeId+'" class="'+i.className.ICON+' add"></span>'),e.edit.showEditBtn&&o.push('<span id="edit_'+t.nodeId+'" nId="'+t.nodeId+'" class="'+i.className.ICON+' edit"></span>'),e.edit.showRemoveBtn&&o.push('<span id="remove_'+t.nodeId+'" nId="'+t.nodeId+'"  class="'+i.className.ICON+' remove"></span>'),o.join("")):""},replaceSwitchClass:function(t){var e=t.className;e=-1!==e.indexOf(i.floder.OPEN)?e.replace(new RegExp(i.floder.OPEN,"ig"),i.floder.CLOSE):e.replace(new RegExp(i.floder.CLOSE,"ig"),i.floder.OPEN),t.className=e},replaceChkClass:function(t,e){t.className=t.className.replace(new RegExp(e?"false":"true"),e?"true":"false")}},s=function(i,o){this.$element=i,this.options=t.extend(!0,e,o),this.nodes={},this.prefix="node",this.init()};return s.prototype.init=function(){this.initNodes(this.options.data),this.createTree(),this.eventBind()},s.prototype.initNodes=function(t){if(o.isArray(t)&&0!==t.length)for(var e,i=0;i<t.length;i++)e=t[i],0===e.parentId&&0===i&&i+1<t.length&&(e.isFirst=!0),i+1===t.length&&(e.isLast=!0),e.hasChildren=this.hasChildren(e),this.nodes[this.prefix+e.nodeId]=e,this.initNodes(e.nodes)},s.prototype.eventBind=function(){var e=this;this.$element.on("click","."+i.className.SWITCH,function(){var i=t(this),o=i.attr("nId"),s=e.$element.find("#ul_"+o),h=e.$element.find("#icon_"+o);0!==s.length&&(s.slideToggle("fast"),n.replaceSwitchClass(this),n.replaceSwitchClass(h[0]))}).on("click",".chk",function(){var i=t(this),o=i.attr("nId"),s=e.getNode(o),h=this.className,r=e.getCheckedNodes();if(!s.chkDisabled)if(s.checked=-1===h.indexOf("true"),n.replaceChkClass(this,s.checked),"checkbox"===e.options.check.chkType)e.check(s);else for(var a=0;a<r.length;a++)r[a]!=s&&(r[a].checked=!1,n.replaceChkClass(document.getElementById("chk_"+r[a].nodeId),!1))}).on("click","a",function(){var o=t(this);o.hasClass(i.node.SELECTED)||(e.$element.find("a").removeClass(i.node.SELECTED),o.addClass(i.node.SELECTED))}).on("click",".add",function(){t(this)}).on("click",".edit",function(){t(this)}).on("click",".remove",function(){t(this)})},s.prototype.createTree=function(){var e=[];e.push('<ul class="k-tree">'),this.createNode(this.options.data,e),e.push("</ul>"),this.$tree=t(e.join("")),this.$element.append(this.$tree)},s.prototype.createNode=function(t,e,i){var s,h="line";if(o.isArray(t)&&0!==t.length&&o.isArray(e)){i&&(i.isLast&&(h=""),e.push(i.open?'<ul id="ul_'+i.nodeId+'" class="'+h+'">':'<ul id="ul_'+i.nodeId+'" style="display:none;" class="'+h+'" >'));for(var s,r=0;r<t.length;r++)s=this.getNode(t[r].nodeId),s&&(e.push('<li id="li_'+s.nodeId+'" nId="'+s.nodeId+'">'),e.push(n.getLineHtml(s)),e.push(n.getChkHtml(s,this.options)),e.push('<a href="javascript:void(0);" id="a_'+s.nodeId+'" nId="'+s.nodeId+'">'),e.push(n.getIconHtml(s)),e.push("<span>"+s.text+"</span>"),e.push(n.getOperateHtml(s,this.options)),e.push("</a>"),this.createNode(s.nodes,e,s),e.push("</li>"));i&&e.push("</ul>")}},s.prototype.addNodes=function(e,n){var e,s=[];if(o.isArray(n)||(n=[n]),e=e||this.getNode(n[0].parentId),this.initNodes(n),this.createNode(n,s),e){var h=this.$tree.find("#li_"+e.nodeId),r=h.find("#ul_"+e.nodeId);if(0===r.length){e.nodes=n;var a=h.find("#"+i.className.SWITCH+"_"+e.nodeId),l=h.find("#"+i.className.ICON+"_"+e.nodeId);r=t('<ul class="'+(e.isLast?"":"line")+'" />').attr("id","ul_"+e.nodeId),a[0].className=a[0].className.replace(i.floder.DOCU,i.floder.OPEN),l[0].className=l[0].className.replace(i.floder.DOCU,i.floder.OPEN)}else{var d=e.nodes[e.nodes.length-1],c=h.find("#li_"+d.nodeId),a=c.find("#"+i.className.SWITCH+"_"+d.nodeId);a[0].className=a[0].className.replace(i.line.BOTTOM,i.line.CENTER),Array.prototype.push.apply(e.nodes,n)}r.append(s.join("")).appendTo(h)}else{var c=this.$tree.children("li").last(),p=c.find("#ul_"+c.attr("nid"));p.addClass("line"),this.$tree.append(s.join(""))}},s.prototype.removeNode=function(t){if(t&&o.isArray(t.nodes)){for(var e=0;e<t.nodes.length;e++)this.removeNode(t.nodes[e]),delete this.nodes[this.prefix+t.nodes[e].nodeId];delete this.nodes[this.prefix+t.nodeId]}},s.prototype.check=function(t){function e(t,e){for(var i=!0;t&&o.isArray(t.nodes);){for(var n,s=0;s<t.nodes.length;s++)if(n=t.nodes[s],n.checked){i=!1;break}if(!i)return;this.checkAction([t],e),i=!0,t=this.getNode(t.parentId)}}var i=this.getParentNodes(t),n=this.getChildNodes(t),s=this.getNode(t.parentId),h=this.options;if(t.checked)switch(h.check.chkBoxType.Y.toLowerCase()){case"p":this.checkAction(i,t.checked);break;case"s":this.checkAction(n,t.checked);break;default:this.checkAction(i,t.checked),this.checkAction(n,t.checked)}else switch(h.check.chkBoxType.N.toLowerCase()){case"p":e.call(this,s,t.checked);break;case"s":this.checkAction(n,t.checked);break;default:e.call(this,s,t.checked),this.checkAction(n,t.checked)}},s.prototype.checkAction=function(t,e){for(var i,o,s=0;s<t.length;s++)i=t[s],i.checked=e,o=document.getElementById("chk_"+i.nodeId),i.chkDisabled||n.replaceChkClass(o,e)},s.prototype.getParentChildNodes=function(t){var e=this.getParentNodes(t);return this.getChildNodes(t,e),e},s.prototype.getParentNodes=function(t){for(var e=this.nodes[this.prefix+t.parentId],i=[];e;)i.push(e),e=this.nodes[this.prefix+e.parentId];return i},s.prototype.getChildNodes=function(t,e){if(e||(e=[]),!o.isArray(t.nodes))return e;for(var i=0;i<t.nodes.length;i++)e.push(t.nodes[i]),this.getChildNodes(t.nodes[i],e);return e},s.prototype.getSelectedNode=function(){var t=this.$element.find("a.selected");if(0===t.length)return null;var e=t.attr("nId");return this.getNode(e)},s.prototype.getCheckedNodes=function(){var t=[];for(var e in this.nodes)this.nodes[e].checked&&t.push(this.nodes[e]);return t},s.prototype.getNode=function(t){return this.nodes[this.prefix+t]},s.prototype.hasChildren=function(t){return t&&o.isArray(t.nodes)&&t.nodes.length>0?!0:!1},s}),define("kotenei/util",function(){var t={},e=function(){};return t.createProto=Object.__proto__?function(t){return{__proto__:t}}:function(t){return e.prototype=t,new e},t}),define("kotenei/validate",["jquery"],function(t){function e(i,o){this.$form=i,this.options=t.extend({},e.DEFAULTS,o),this.rules=this.options.rules,this.messages=this.options.messages,this.init()}return e.DEFAULTS={errorClass:"error",errorElement:"label",rules:{},messages:{},focusClear:!0,keyupClear:!0,errorPlacement:null},e.prototype.init=function(){this.getValidFields(),0!==this.validFields.count&&this.eventBind()},e.prototype.getValidFields=function(){this.validFields={data:{},count:0};{var e=this;this.$form.find("input,select,textarea").filter(function(){return this.name in e.rules?!0:!1}).each(function(){e.validFields.data[this.name]||(e.validFields.data[this.name]=t(this),e.validFields.count++)})}},e.prototype.eventBind=function(){var t=this;this.$form.on("submit",function(e){return t.validateFrom(e)}).on("focus blur keyup",':text, [type="password"], [type="file"], select, textarea, [type="number"], [type="search"] ,[type="tel"], [type="url"], [type="email"], [type="datetime"], [type="date"], [type="month"], [type="week"], [type="time"], [type="datetime-local"], [type="range"], [type="color"]',function(e){t.validate(e)}).on("click",'[type="radio"], [type="checkbox"], select, option',function(e){t.validate(e)})},e.prototype.validate=function(e){var i,o,n=e.target,s=t(n),h=this.rules[n.name];if(this.options.focusClear&&"focusin"===e.type||this.options.keyupClear&&"keyup"===e.type)return void this.hideError(s);if(h){o=this.elementValue(s);for(var r in h){var a={method:r,parameters:h[r]};if(i=this.methods[r].call(this,o,s,a.parameters),!i)return this.formatAndAdd(n,a),!1;this.hideError(s)}return!0}},e.prototype.validateFrom=function(){var t=this,e=!0;for(var i in this.validFields.data)t.validate({target:this.validFields.data[i][0]})||(e=!1);return e},e.prototype.valid=function(){return this.validateFrom()},e.prototype.checkable=function(t){return/radio|checkbox/i.test(t.type)},e.prototype.formatAndAdd=function(e,i){var o=t(e),n=this.defaultMessage(e,i.method);n=this.format(n,i.parameters),this.showError(o,n)},e.prototype.showError=function(e,i){this.checkable(e[0])&&(e=this.validFields.data[e[0].name]);var o=e.data("error");o||(o=t("<"+this.options.errorElement+">").addClass(this.options.errorClass),e.data("error",o)),o.html(i).show(),e.addClass(this.options.errorClass),t.isFunction(this.options.errorPlacement)?this.options.errorPlacement(e,o):o.insertAfter(e)},e.prototype.hideError=function(e){this.checkable(e[0])&&(e=this.validFields.data[e[0].name]);var i=e.data("error");e.removeClass(this.options.errorClass),t.isFunction(this.options.errorPlacement)&&this.options.errorPlacement(e,t([])),i&&i.hide()},e.prototype.defaultMessage=function(t,e){return this.messages[t.name]||(this.messages[t.name]={},this.messages[t.name][e]=this.errorMessages[e]),this.messages[t.name][e]||(this.messages[t.name][e]=this.errorMessages[e]),this.messages[t.name][e]},e.prototype.format=function(e,i){return-1!=e.indexOf("{0}")&&(i.constructor!==Array&&(i=[i]),t.each(i,function(t,i){e=e.replace(new RegExp("\\{"+t+"\\}","g"),function(){return i})})),e},e.prototype.addMethod=function(t,e,i){this.methods[t]=e,this.errorMessages[t]=void 0!==i?i:this.errorMessages[t]},e.prototype.errorMessages={required:"该字段不能为空",email:"电子邮箱格式错误",url:"url格式错误",date:"请输入一个有效日期",dateISO:"请输入一个有效日期（ISO）",mobile:"手机号码格式错误",phone:"电话号码格式错误",number:"请输入一个有效的数字",digits:"请输入正整数",minLength:"请输入一个长度不小于{0}个字符的值",maxLength:"请输入一个长度不大于{0}个字符的值",rangeLength:"请输入一个长度介于{0}到{1}个字符的值",min:"请输入一个大于或等于{0}的值",max:"请输入一个小于或等于{0}的值",range:"请输入一个介于{0}到{1}之间的数值",equalTo:"请再输入一个相同的值",remote:"远程验证失败"},e.prototype.methods={required:function(e,i){if("select"===i[0].nodeName.toLowerCase()){var o=t.trim(i.val());return o&&o.length>0}return this.checkable(i[0])?this.getLength(e,i[0])>0:t.trim(e).length>0},email:function(t,e){return this.optional(e)||/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i.test(t)},url:function(t,e){return this.optional(e)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)},date:function(t,e){return this.optional(e)||!/Invalid|NaN/.test(new Date(t).toString())},dateISO:function(t,e){return this.optional(e)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}|\d{4}[\/-]\d{1,2}[\/-]\d{1,2}\s\d{1,2}[:]\d{1,2}[:]\d{1,2}\w$/.test(t)},mobile:function(t,e){return this.optional(e)||/^((13[0-9])|(15[^4,\\D])|(18[0,5-9]))\d{8}$/.test(t)},phone:function(t,e){return this.optional(e)||/^((0\d{2,3}\-)[1-9]\d{7}(\-\d{1,4})?)$/.test(t)},number:function(t,e){return this.optional(e)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},digits:function(t,e){return this.optional(e)||/^\d+$/.test(t)},minLength:function(e,i,o){var n=t.isArray(e)?e.length:this.getLength(t.trim(e),i[0]);return this.optional(i)||n>=o},maxLength:function(e,i,o){var n=t.isArray(e)?e.length:this.getLength(t.trim(e),i[0]);return this.optional(i)||o>=n},rangeLength:function(e,i,o){var n=t.isArray(e)?e.length:this.getLength(t.trim(e),i[0]);return this.optional(i)||n>=o[0]&&n<=o[1]},min:function(t,e,i){return this.optional(e)||t>=i},max:function(t,e,i){return this.optional(e)||i>=t},range:function(t,e,i){return this.optional(e)||t>=i[0]&&t<=i[1]},equalTo:function(e,i,o){var i=t(o);return e===this.elementValue(i)},remote:function(e,i,o){var n,s={},h=this,r=this.previousValue(i[0]);return r.old===e?r.valid:(r.old=e,"string"==typeof o?n=o:(n=o.url,s=o.data),s[i[0].name]=e,s.rnd=Math.random(),t.post(n,s).success(function(t){var e=t===!0||"true"===t;e?h.hideError(i):h.showError(i,r.message),r.valid=e}).error(function(){return!1}),!0)}},e.prototype.previousValue=function(e){return t.data(e,"previousValue")||t.data(e,"previousValue",{old:null,valid:!0,message:this.defaultMessage(e,"remote")})},e.prototype.optional=function(t){var e=this.elementValue(t);return!this.methods.required.call(this,e,t)},e.prototype.elementValue=function(e){var i=e.attr("type"),o=e.val();return"radio"===i||"checkbox"===i?t("input[name='"+e.attr("name")+"']:checked").val():"string"==typeof o?o.replace(/\r/g,""):o},e.prototype.getLength=function(e,i){switch(i.nodeName.toLowerCase()){case"select":return t("option:selected",i).length;case"input":if(this.checkable(i))return this.$form.find("[name='"+i.name+"']").filter(":checked").length}return e.length},e.prototype.getData=function(){var e={},i=this;return i.$form.find("input[name], textarea[name]").each(function(){var i=t(this);if(i.is("[type=checkbox]")===!1&&i.is("[type=radio]")===!1)e[i.attr("name")]=t.trim(i.val());else if(i.is("[type=radio]:checked"))e[i.attr("name")]=t.trim(i.val());else if(i.is("[type=checkbox]:checked")){var o=i.attr("name");e[o]||(e[o]=[]),e[o].push(i.val())}}),e},e}),define("kotenei/validateTooltips",["jquery","kotenei/validate","kotenei/tooltips","kotenei/util"],function(t,e,i,o){var n=function(t,i){e.call(this,t,i)};return n.prototype=o.createProto(e.prototype),n.prototype.getTipsPlacement=function(t){var e=t.name,i="right";return this.tipsPlacement||(this.tipsPlacement=this.options.tipsPlacement||{}),this.tipsPlacement[e]?i=this.tipsPlacement[e]:this.tipsPlacement[e]=i,i},n.prototype.showError=function(t,e){this.checkable(t[0])&&(t=this.validFields.data[t[0].name]);var o=this.getTipsPlacement(t[0]),n=i.Get(t);n?n.setContent(e):(n=new i(t,{content:e,tipClass:"danger",trigger:"manual",placement:o,container:this.options.container||document.body,scrollContainer:this.options.scrollContainer}),i.Set(t,n)),n.show(),t.addClass(this.options.errorClass)},n.prototype.hideError=function(t){this.checkable(t[0])&&(t=this.validFields.data[t[0].name]);var e=i.Get(t);e&&e.hide(),t.removeClass(this.options.errorClass)},n}),define("kotenei/waterfall",["jquery","kotenei/infiniteScroll","kotenei/popTips"],function(t,e,i){var o=function(e,i){this.$element=e,this.options=t.extend({},{width:200,margin:10,nodeTag:"li",resize:!1,url:null,loaded:t.noop},i),this.$window=t(window),this.$document=t(document),this.node_w=this.options.width+this.options.margin,this.loading=!1,this.noMore=!1,this.init()};return o.prototype.init=function(){var i=this;this.arrangementInit(),this.infiniteScroll=new e({$watchElement:this.$element,scrollDistance:0,callback:function(){return i.options.url?void i.remote():void(i.options.data&&i.options.data.length>0&&i.options.loaded.call(i,i.$element,i.options.data))}}),this.options.resize&&(this.$element.css("position","static"),this.$window.on("resize.waterfall",t.proxy(this.arrangementInit,this)))},o.prototype.arrangementInit=function(){this.arrHeight=[],this.nodes=this.$element.children(this.options.nodeTag);for(var t,e,i=this.options.resize?this.$document.width()/this.node_w|0:this.$element.width()/this.node_w|0,o=0;o<this.nodes.length;o++)e=this.nodes.eq(o),t=e.outerHeight(),i>o?(this.arrHeight[o]=t,e.css({top:0,left:o*this.node_w})):this.set(e,t);this.adpHeight()},o.prototype.arrangement=function(e){var i=this;return 0===this.arrHeight.length?void this.arrangementInit():void(e&&0!==e.length&&(e.each(function(){var e=t(this),o=e.outerHeight();i.set(e,o)}),this.adpHeight()))},o.prototype.set=function(t,e){var i=this.getMinHeight(),o=this.getMinHeightIndex(i);o=-1==o?0:o,this.arrHeight[o]+=e+this.options.margin,t.css({top:i+this.options.margin,left:o*this.node_w})},o.prototype.getMinHeightIndex=function(t){if(Array.indexOf){var e=this.arrHeight.indexOf(t);return e}for(var i=0;i<this.arrHeight;i++)if(this.arrHeight[i]===t)return i},o.prototype.remote=function(){if(!this.noMore&&!this.loading){var e=this;this.loading=!0,t.get(this.options.url,{rnd:Math.random()}).done(function(t){return t&&0!==t.length?(e.options.loaded.call(e,e.$element,t),void(e.loading=!1)):(e.noMore=!0,!1)}).fail(function(){i.error("网络错误！"),e.loading=!1})}},o.prototype.destory=function(){this.infiniteScroll.destory()},o.prototype.imgLoad=function(t,e,i){var o=new Image,n=this;o.onload=function(){t.attr("src",e),i(n.zoom(o.width,o.height))},o.onerror=function(){i({width:n.options.width,height:300})},o.src=e},o.prototype.zoom=function(t,e){var i;return t>e||t==e?(i=t/e,e=this.options.width/i):(i=e/t,e=this.options.width*i),{width:this.options.width,height:e}},o.prototype.getMinHeight=function(){return Math.min.apply(null,this.arrHeight)},o.prototype.getMaxHeight=function(){return Math.max.apply(null,this.arrHeight)},o.prototype.adpHeight=function(){this.$element.height(this.getMaxHeight())},o}),define("kotenei/window",["jquery","kotenei/dragdrop","kotenei/popTips"],function(t){var e=function(e){this.options=t.extend({},{url:null,params:null,title:"弹出框",content:null,width:"600",height:null,backdrop:!0,backdropClose:!1},e),this._event={open:t.noop,ok:t.noop,close:t.noop},this.loading=!1,this.template='<div class="k-window"><h4 class="k-window-header"><span class="k-window-title"></span><span class="k-window-close">×</span></h4><div class="k-window-container"></div><div class="k-window-footer"><button type="button" class="btn btn-primary k-window-ok">确定</button><button type="button" class="btn btn-default k-window-cancel">取消</button></div></div>',this.backdrop='<div class="k-window-backdrop"></div>',this.$document=t(document),this.$window=t(window),this.init()};e.prototype.init=function(){this.build(),this.setTitle(this.options.title),null!==this.options.content&&this.setContent(this.options.content),this.eventBind()},e.prototype.eventBind=function(){var t=this;this.$window.on("resize.window",function(){t.layout()}),this.$backdrop.on("click",function(){t.options.backdropClose&&t.close()}),this.$win.on("click",".k-window-cancel,.k-window-close",function(){t.close()}).on("click",".k-window-ok",function(){t._event.ok.call(t)!==!1&&t.hide()})},e.prototype.on=function(e,i){this._event.hasOwnProperty(e)&&(this._event[e]=i||t.noop)},e.prototype.setTitle=function(t){this.$header.find(".k-window-title").text(t)},e.prototype.setContent=function(t){t=t||this.options.content,this.$container.html(t)},e.prototype.remote=function(){if("string"==typeof this.options.url&&null==this.options.content){var e=this,i=t.Deferred();return this.loading=!0,this.$container.load(this.options.url+"?rnd="+Math.random(),this.options.params,function(){e.loading=!1,i.resolve()}),i.promise()}},e.prototype.open=function(){var e=this;t.when(this.remote()).done(function(){e.$win.show(),e.options.backdrop&&e.$backdrop.show(),e.layout(),e._event.open(e.$win);var t=i.get();e.$win.css("zIndex",t),e.$backdrop.css("zIndex",--t)})},e.prototype.close=function(t){return t?void this.hide():void(this._event.close()!==!1&&this.hide())},e.prototype.hide=function(){this.$win.hide(),this.$backdrop.hide(),i.pop()},e.prototype.layout=function(){var t,e,i=this.$window.height(),o=i-100,n=this.$header.height(),s=this.$footer.height(),h=o-n-s;this.options.height?o<this.options.height?(t=o,e=h):(t=this.options.height,e=t-n-s):(this.orgHeight=this.orgHeight||this.$win.height(),o<this.orgHeight?(t=o,e=h):(t=this.orgHeight,e=this.orgHeight-n-s)),this.$container.css("height",e),this.$win.css({height:t,marginLeft:-this.$win.width()/2,marginTop:-t/2})},e.prototype.build=function(){this.$win=t(this.template).css({width:this.options.width,height:this.options.height}),this.$backdrop=t(this.backdrop),this.$header=this.$win.find(".k-window-header"),this.$container=this.$win.find(".k-window-container"),this.$footer=this.$win.find(".k-window-footer"),this.$win.appendTo(document.body),this.$backdrop.appendTo(document.body)},e.alert=function(i,o,n){t.isFunction(o)&&(n=o,o=i,i="提示");var s=new e({width:400,backdropClose:!1});s.$win.find(".k-window-cancel").hide(),s.setTitle(i),s.setContent(o),s.on("ok",n||t.noop),s.open()},e.confirm=function(i,o,n,s){t.isFunction(o)&&(s=n,n=o,o=i,i="确认提示");var h=new e({width:400,backdropClose:!1});h.setTitle(i),h.setContent(o),h.on("ok",n||t.noop),h.on("close",s||t.noop),h.open()};var i=function(){var t=[];return{get:function(){var e;return 0===t.length?(e=1e3,t.push(e)):(e=t[t.length-1],e+=2,t.push(e)),e},pop:function(){0!==t.length&&t.pop()}}}();return e}),define("kotenei/wordLimit",["jquery"],function(t){var e=function(e,i){this.$element=e,this.options=t.extend({},{maxLength:140,feedback:".chars"},i),this.init()};return e.prototype.init=function(){var e=this;this.maxLength=parseInt(this.$element.attr("maxLength")||this.options.maxLength),this.$feedback=t(this.options.feedback),this.$element.on("keyup",function(){var i=t.trim(t(this).val());e.update(i)}),this.update(t.trim(this.$element.val()))},e.prototype.update=function(t){var e=t.length,i=this.maxLength,o=i-e;e>=i&&this.$element.val(t.substring(0,i)),this.$feedback.html(0>o?0:o)},e.Global=function(i){i=i||t("input,textarea").filter('[data-module="wordlimit"]'),i.each(function(){var i=t(this),o=i.attr("maxLength"),n=e.Get(i);o&&(n||(n=new e(i,{maxLength:o,feedback:i.attr("data-feedback")}),e.Set(i,n)))})},e.Get=function(t){return t.data("wordLimit")},e.Set=function(t,e){t.data("wordLimit",e)},e}),define("kotenei",["kotenei/autoComplete","kotenei/cache","kotenei/clipZoom","kotenei/dragdrop","kotenei/dropdown","kotenei/dropdownDatepicker","kotenei/infiniteScroll","kotenei/lazyload","kotenei/loading","kotenei/pager","kotenei/placeholder","kotenei/popTips","kotenei/router","kotenei/slider","kotenei/switch","kotenei/tooltips","kotenei/tree","kotenei/util","kotenei/validate","kotenei/validateTooltips","kotenei/waterfall","kotenei/window","kotenei/wordLimit"],function(t,e,i,o,n,s,h,r,a,l,d,c,p,u,f,g,m,v,w,y,$,k,b){return{AutoComplete:t,cache:e,ClipZoom:i,Dragdrop:o,Dropdown:n,DropdownDatepicker:s,InfiniteScroll:h,lazyload:r,Loading:a,Pager:l,placeholder:d,popTips:c,Router:p,Slider:u,Switch:f,Tooltips:g,Tree:m,Util:v,Validate:w,ValidateTooltips:y,Waterfall:$,Window:k,WordLimit:b}});